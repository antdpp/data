plt.figure(1, figsize=(24, 12))  # Increase the figsize to make the subplots larger

# Average relative error
ax = plt.subplot(1, 3, 1)
err = np.mean(100 * np.abs((X_sample - prediction) / X_sample), axis=0)
plt.title("Average relative error", fontsize=15, y=1.04)
im = plt.imshow(err.reshape(maturities_dim, strikes_dim).T, aspect='auto')
cbar = plt.colorbar(im, format=mtick.PercentFormatter())
cbar.ax.tick_params(labelsize=12)
ax.set_xticks(np.arange(maturities_dim))
ax.set_xticklabels(expiries[:maturities_dim])
ax.set_yticks(np.arange(strikes_dim))
ax.set_yticklabels(logMoneyness[:strikes_dim])
plt.xlabel("Maturity", fontsize=15, labelpad=5)
plt.ylabel("Log-Moneyness", fontsize=15, labelpad=5)

# Std relative error
ax = plt.subplot(1, 3, 2)
err = 100 * np.std(np.abs((X_sample - prediction) / X_sample), axis=0)
plt.title("Std relative error", fontsize=15, y=1.04)
im = plt.imshow(err.reshape(maturities_dim, strikes_dim).T, aspect='auto')
cbar = plt.colorbar(im, format=mtick.PercentFormatter())
cbar.ax.tick_params(labelsize=12)
ax.set_xticks(np.arange(maturities_dim))
ax.set_xticklabels(expiries[:maturities_dim])
ax.set_yticks(np.arange(strikes_dim))
ax.set_yticklabels(logMoneyness[:strikes_dim])
plt.xlabel("Maturity", fontsize=15, labelpad=5)
plt.ylabel("Log-Moneyness", fontsize=15, labelpad=5)

# Maximum relative error
ax = plt.subplot(1, 3, 3)
err = 100 * np.max(np.abs((X_sample - prediction) / X_sample), axis=0)
plt.title("Maximum relative error", fontsize=15, y=1.04)
im = plt.imshow(err.reshape(maturities_dim, strikes_dim).T, aspect='auto')
cbar = plt.colorbar(im, format=mtick.PercentFormatter())
cbar.ax.tick_params(labelsize=12)
ax.set_xticks(np.arange(maturities_dim))
ax.set_xticklabels(expiries[:maturities_dim])
ax.set_yticks(np.arange(strikes_dim))
ax.set_yticklabels(logMoneyness[:strikes_dim])
plt.xlabel("Maturity", fontsize=15, labelpad=5)
plt.ylabel("Log-Moneyness", fontsize=15, labelpad=5)

# Adjust layout to prevent overlap and save the plot
plt.tight_layout()
plt.subplots_adjust(wspace=0.4, hspace=0.4)  # Adjust spacing between subplots
plt.savefig('rBergomiTermStructureNNErrors.PNG', dpi=300)
plt.show()
